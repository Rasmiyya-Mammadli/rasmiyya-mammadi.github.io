"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[362],{5362:(W,g,n)=>{n.r(g),n.d(g,{UserModule:()=>X});var s=n(6895),p=n(8252),i=n(4006),h=n(2843),P=n(8746),Z=n(262),U=n(592),F=n(3606),v=n(7157),r=n(4650),x=n(9668),_=n(5938),A=n(8044),M=n(9653),C=n(1591),d=n(3416),O=n(4859),T=n(7392),c=n(9549),S=n(4144),m=n(3546);function I(o,a){1&o&&(r.TgZ(0,"div",14)(1,"mat-card-title"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r._UZ(4,"img",15),r.qZA()),2&o&&(r.xp6(2),r.Oqu(r.lcZ(3,1,"USER_PAGE.title")))}function R(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.nameFormErrorReq")," "))}function b(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.nameFormErrorMinL")," "))}function E(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.nameFormErrorMaxL")," "))}function N(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.nameFormErrorRegx")," "))}function L(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.loginFormErrorReq")," "))}function w(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.loginFormErrorMinL")," "))}function J(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.loginFormErrorMaxL")," "))}function y(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.loginFormErrorRegx")," "))}function Y(o,a){1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&o&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"FORM.passwordErrorRequest")," "))}function j(o,a){if(1&o&&(r.TgZ(0,"li"),r._uU(1),r.qZA()),2&o){const t=r.oxw().$implicit;r.xp6(1),r.hij(" ",t.value," ")}}function Q(o,a){if(1&o&&(r.ynx(0),r.YNc(1,j,2,1,"li",6),r.BQk()),2&o){const t=a.$implicit;r.xp6(1),r.Q6J("ngIf",t.value)}}function q(o,a){if(1&o&&(r.TgZ(0,"mat-error"),r._uU(1),r.ALo(2,"translate"),r.TgZ(3,"ul"),r.YNc(4,Q,2,1,"ng-container",16),r.ALo(5,"keyvalue"),r.qZA()()),2&o){const t=r.oxw();r.xp6(1),r.hij(" ",r.lcZ(2,2,"FORM.passwordErrorRegx")," "),r.xp6(3),r.Q6J("ngForOf",r.lcZ(5,4,null==t.ProfileForm.controls.password.errors?null:t.ProfileForm.controls.password.errors.errorMsg))}}function V(o,a){if(1&o&&(r.TgZ(0,"button",17),r._UZ(1,"mat-icon",18),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&o){const t=r.oxw();r.Q6J("disabled",t.isSubmitted),r.xp6(2),r.hij(" ",r.lcZ(3,2,"USER_PAGE.save")," ")}}function z(o,a){1&o&&(r.TgZ(0,"span",19),r._UZ(1,"mat-icon",20),r._uU(2),r.ALo(3,"translate"),r.qZA()),2&o&&(r.xp6(2),r.hij("",r.lcZ(3,1,"USER_PAGE.successSaved")," "))}const G=function(o){return{mb60:o}},B=[{path:"",component:(()=>{class o{constructor(t,e,l,u,f,D){this.userService=t,this.dialog=e,this.notificationService=l,this.store=u,this.formValidationService=f,this.translateService=D,this.isSubmitted=!1,this.isSuccessSubmitted=!1,this.ProfileForm=new i.cw({name:new i.NI("",[i.kI.required,i.kI.minLength(2),i.kI.maxLength(20),this.formValidationService.ownValidator(/^([A-Za-z\u0410]+)( ?)([A-Za-z\u0410]+)?$/i)]),login:new i.NI("",[i.kI.required,i.kI.minLength(2),i.kI.maxLength(20),this.formValidationService.ownValidator(/^([A-Za-z0-9]+)$/i)]),password:new i.NI("",[i.kI.required,this.formValidationService.passValidator()])},{updateOn:"submit"})}ngOnInit(){this.store.select(U.PR).subscribe(t=>{t&&(this.User=t,this.ProfileForm.setValue({name:t.name||"",login:t.login,password:""}),t.name||this.store.dispatch(F.BT()))})}handleHTTPError(t){return this.notificationService.openNotification(this.translateService.instant(409===t.status?"API_ERRORS.authError":400===t.status?"API_ERRORS.bodyRequest":"API_ERRORS.unknowError")),(0,h._)(()=>t)}onSubmit(t){this.ProfileForm.valid&&(this.isSubmitted=!0,this.userService.updateUser({name:this.ProfileForm.controls.name.value,login:this.ProfileForm.controls.login.value,password:this.ProfileForm.controls.password.value},this.User._id).pipe((0,P.x)(()=>{this.isSubmitted=!1}),(0,Z.K)(e=>this.handleHTTPError(e))).subscribe({next:()=>{this.isSuccessSubmitted=!0,t.resetForm(),this.ProfileForm.setValue({name:this.User.name,login:this.User.login,password:""}),setTimeout(()=>{this.isSuccessSubmitted=!1},3e3)},error:()=>{}}))}openConfirmModal(){(0,v.G)(this.dialog,this.userService.deleteUser(this.User._id),this.translateService.instant("CONFIRM_MODAL.targetAccount"))}}return o.\u0275fac=function(t){return new(t||o)(r.Y36(x.K),r.Y36(_.uw),r.Y36(A.g),r.Y36(M.yh),r.Y36(C.m),r.Y36(d.sK))},o.\u0275cmp=r.Xpm({type:o,selectors:[["app-user-page"]],decls:38,vars:29,consts:[[1,"mat-card-profile"],["class","profile__header",4,"ngIf"],[1,"form",3,"formGroup","submit"],["formDirective","ngForm"],["appearance","outline",1,"full-width"],["id","name","matInput","","formControlName","name"],[4,"ngIf"],["id","login","matInput","","formControlName","login"],["appearance","outline",1,"full-width",3,"ngClass"],["id","password","type","password","matInput","","formControlName","password"],["class","form__btn full-width","type","submit","color","warn","mat-flat-button","",3,"disabled",4,"ngIf","ngIfElse"],["successNote",""],["type","button","color","basic","mat-flat-button","",3,"click"],["color","warn","aria-hidden","true","aria-label","Delete account","fontIcon","person_remove"],[1,"profile__header"],["src","../../../../assets/images/avatar.png","alt","avatar"],[4,"ngFor","ngForOf"],["type","submit","color","warn","mat-flat-button","",1,"form__btn","full-width",3,"disabled"],["aria-hidden","true","aria-label","Save","fontIcon","save"],[1,"submitted-success"],["color","green","aria-hidden","true","aria-label","submitted","fontIcon","check_small"]],template:function(t,e){if(1&t){const l=r.EpF();r.TgZ(0,"mat-card",0),r.YNc(1,I,5,3,"div",1),r.TgZ(2,"mat-card-content")(3,"form",2,3),r.NdJ("submit",function(){r.CHM(l);const f=r.MAs(4);return r.KtG(e.onSubmit(f))}),r.TgZ(5,"mat-form-field",4)(6,"mat-label"),r._uU(7),r.ALo(8,"translate"),r.qZA(),r._UZ(9,"input",5),r.YNc(10,R,3,3,"mat-error",6),r.YNc(11,b,3,3,"mat-error",6),r.YNc(12,E,3,3,"mat-error",6),r.YNc(13,N,3,3,"mat-error",6),r.qZA(),r.TgZ(14,"mat-form-field",4)(15,"mat-label"),r._uU(16),r.ALo(17,"translate"),r.qZA(),r._UZ(18,"input",7),r.YNc(19,L,3,3,"mat-error",6),r.YNc(20,w,3,3,"mat-error",6),r.YNc(21,J,3,3,"mat-error",6),r.YNc(22,y,3,3,"mat-error",6),r.qZA(),r.TgZ(23,"mat-form-field",8)(24,"mat-label"),r._uU(25),r.ALo(26,"translate"),r.qZA(),r._UZ(27,"input",9),r.YNc(28,Y,3,3,"mat-error",6),r.YNc(29,q,6,6,"mat-error",6),r.qZA(),r.YNc(30,V,4,4,"button",10),r.YNc(31,z,4,3,"ng-template",null,11,r.W1O),r.TgZ(33,"mat-card-footer")(34,"button",12),r.NdJ("click",function(){return e.openConfirmModal()}),r._UZ(35,"mat-icon",13),r._uU(36),r.ALo(37,"translate"),r.qZA()()()()()}if(2&t){const l=r.MAs(32);r.xp6(1),r.Q6J("ngIf",e.User),r.xp6(2),r.Q6J("formGroup",e.ProfileForm),r.xp6(4),r.Oqu(r.lcZ(8,19,"FORM.labelName")),r.xp6(3),r.Q6J("ngIf",null==e.ProfileForm.controls.name.errors?null:e.ProfileForm.controls.name.errors.required),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.name.errors?null:e.ProfileForm.controls.name.errors.minlength),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.name.errors?null:e.ProfileForm.controls.name.errors.maxlength),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.name.errors?null:e.ProfileForm.controls.name.errors.errorMsg),r.xp6(3),r.Oqu(r.lcZ(17,21,"FORM.labelLogin")),r.xp6(3),r.Q6J("ngIf",null==e.ProfileForm.controls.login.errors?null:e.ProfileForm.controls.login.errors.required),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.login.errors?null:e.ProfileForm.controls.login.errors.minlength),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.login.errors?null:e.ProfileForm.controls.login.errors.maxlength),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.login.errors?null:e.ProfileForm.controls.login.errors.errorMsg),r.xp6(1),r.Q6J("ngClass",r.VKq(27,G,null==e.ProfileForm.controls.password.errors?null:e.ProfileForm.controls.password.errors.errorMsg)),r.xp6(2),r.Oqu(r.lcZ(26,23,"FORM.labelPass")),r.xp6(3),r.Q6J("ngIf",null==e.ProfileForm.controls.password.errors?null:e.ProfileForm.controls.password.errors.required),r.xp6(1),r.Q6J("ngIf",null==e.ProfileForm.controls.password.errors?null:e.ProfileForm.controls.password.errors.errorMsg),r.xp6(1),r.Q6J("ngIf",!e.isSuccessSubmitted)("ngIfElse",l),r.xp6(6),r.hij(" ",r.lcZ(37,25,"USER_PAGE.delete")," ")}},dependencies:[s.mk,s.sg,s.O5,O.lW,T.Hw,c.KE,c.hX,c.TO,S.Nt,m.a8,m.dn,m.rt,m.n5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,s.Nd,d.X$],styles:["[_nghost-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center;padding:1rem}.full-width[_ngcontent-%COMP%]{width:100%}.mat-card-profile[_ngcontent-%COMP%]{max-width:360px;margin:0 10px;padding:40px;box-shadow:0 0 10px #0000001a}.profile__header[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;margin-bottom:10px}.profile__header[_ngcontent-%COMP%]   .mat-card-title[_ngcontent-%COMP%]{position:absolute;top:-30px}.profile__header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:240px}.mat-card-footer[_ngcontent-%COMP%]{margin:30px 0 -20px}.mat-error[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:4px}.mat-error[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .bullet[_ngcontent-%COMP%]{font-size:16px}.form__btn[_ngcontent-%COMP%]{height:44px}.mb60[_ngcontent-%COMP%]{margin-bottom:60px}.submitted-success[_ngcontent-%COMP%]{height:44px;display:flex;align-items:center;justify-content:center;color:#228b22}"]}),o})()}];let K=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[p.Bz.forChild(B),p.Bz]}),o})();var $=n(6335),H=n(3602);let X=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=r.oAB({type:o}),o.\u0275inj=r.cJS({imports:[s.ez,K,$.q,i.UX,H.m]}),o})()}}]);