"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[278],{7278:(Rt,q,l)=>{l.r(q),l.d(q,{BoardsModule:()=>Lt});var m=l(6895),A=l(8252),$=l(6335),s=l(4006),c=l(9653);const D=(0,c.ZF)("boards"),J=(0,c.P1)(D,n=>n.boards),L=(0,c.P1)(D,n=>n.error);var t=l(4650),Y=l(2595),M=l(8044),u=l(4859),B=l(6338),v=l(7066),R=l(592),U=l(9668),f=l(7392),p=l(9549),x=l(4144),w=l(4385),P=l(3238),g=l(3416);function X(n,r){1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CREATE_BOARD.formError")," "))}function H(n,r){if(1&n&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}let W=(()=>{class n{constructor(e,o,i,a,d,C){this.store=e,this.userStore=o,this.modalsService=i,this.userService=a,this.fb=d,this.notificationService=C}ngOnInit(){this.userSubscription=this.userStore.select(R.PR).subscribe(e=>{this.userId=e?._id}),this.users$=this.userService.getUsers(),this.createBoardForm=this.fb.group({title:["",s.kI.required],usersSelect:[""]})}ngOnDestroy(){this.userSubscription.unsubscribe()}get title(){return this.createBoardForm.get("title")}get usersSelect(){return this.createBoardForm.get("usersSelect")}onSubmit(e){if(this.createBoardForm.valid){const{title:o,usersSelect:i}=this.createBoardForm.value;this.store.dispatch(v.RN({title:o,owner:this.userId,users:i})),this.store.select(L).subscribe(a=>{a&&this.notificationService.openNotification(a)}),this.createBoardForm.reset(),e.resetForm(),this.modalsService.showCreateBoardModal=!1}}onClose(){this.modalsService.showCreateBoardModal=!1}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.yh),t.Y36(c.yh),t.Y36(Y.F),t.Y36(U.K),t.Y36(s.qu),t.Y36(M.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-board"]],decls:26,vars:17,consts:[[1,"create-board","bg-white","rounded-lg","shadow-lg","p-6",3,"formGroup","ngSubmit"],["formDirective","ngForm"],[1,"create-board_container"],[1,"text-2xl","font-bold","mb-6"],[1,"create-board_inputs-container"],["appearance","fill",1,"w-full","mb-4"],["matInput","","formControlName","title","required","",1,"w-full"],[4,"ngIf"],["formControlName","usersSelect","multiple","",1,"w-full"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn","type","submit",1,"w-full","hover:bg-rose-700","text-white","font-bold","py-2","px-4","rounded","mt-4"],["mat-icon-button","",1,"close-modal-button","absolute","top-0","right-0","mt-3","mr-3","bg-rose-300",3,"click"],[3,"value"]],template:function(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"form",0,1),t.NdJ("ngSubmit",function(){t.CHM(i);const d=t.MAs(1);return t.KtG(o.onSubmit(d))}),t.TgZ(2,"div",2)(3,"h2",3),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),t._uU(9),t.ALo(10,"translate"),t.qZA(),t._UZ(11,"input",6),t.YNc(12,X,3,3,"mat-error",7),t.qZA(),t.TgZ(13,"mat-form-field",5)(14,"mat-label"),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"mat-select",8),t.YNc(18,H,2,2,"mat-option",9),t.ALo(19,"async"),t.qZA()()(),t.TgZ(20,"button",10),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"button",11),t.NdJ("click",function(){return o.onClose()}),t.TgZ(24,"mat-icon"),t._uU(25,"close"),t.qZA()()()()}2&e&&(t.Q6J("formGroup",o.createBoardForm),t.xp6(4),t.hij(" ",t.lcZ(5,7,"CREATE_BOARD.title")," "),t.xp6(5),t.Oqu(t.lcZ(10,9,"CREATE_BOARD.label")),t.xp6(3),t.Q6J("ngIf",o.title.invalid),t.xp6(3),t.Oqu(t.lcZ(16,11,"CREATE_BOARD.add-users")),t.xp6(3),t.Q6J("ngForOf",t.lcZ(19,13,o.users$)),t.xp6(3),t.hij(" ",t.lcZ(22,15,"CREATE_BOARD.button")," "))},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,u.lW,u.RK,f.Hw,p.KE,p.hX,p.TO,x.Nt,w.gD,P.ey,m.Ov,g.X$],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;position:fixed;top:0;left:0;background-color:#00000052;z-index:999}.create-board[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;max-width:400px;padding:1rem 4rem;margin:0 1rem;background:linear-gradient(#f6f9fa,#fafdff) no-repeat;border-radius:4px;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}.create-board_container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:center}.create-board_inputs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:2.5rem;width:100%}.close-modal-button[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:inherit}.close-modal-button[_ngcontent-%COMP%]:hover{color:#3f51b5}"]}),n})();var I=l(7157),h=l(3577),T=l(5938),j=l(4850);let V=(()=>{class n{constructor(e,o,i,a,d){this.router=e,this.columnsStore=o,this.boardsStore=i,this.matDialog=a,this.translateService=d}backToBoard(e){this.router.navigate(["/board",e]),this.columnsStore.dispatch(h.So({boardId:e}))}onOpenBoardModal(){const o=this.translateService.instant("CONFIRM_MODAL.targetBoard");(0,I.G)(this.matDialog,()=>{this.boardsStore.dispatch(v.LI({_id:this.board._id}))},o)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.F0),t.Y36(c.yh),t.Y36(c.yh),t.Y36(T.uw),t.Y36(g.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-board"]],inputs:{board:"board"},decls:10,vars:1,consts:[[1,"board_item","rounded-md","p-4","hover:bg-rose-200"],[1,"board_link","flex","items-center","justify-between",3,"click"],["mat-icon-no-color","",1,"board_item-icon","text-gray-700","mr-2","hover:bg-rose-200"],[1,"board_header","text-gray-800","font-medium"],["mat-icon-button","","type","button",1,"board_remove-button","ml-auto",3,"click"],["mat-icon-no-color","",1,"board_remove-btn__icon","text-gray-700"],[1,"my-4"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-list-item",0)(1,"div",1),t.NdJ("click",function(){return o.backToBoard(o.board._id)}),t.TgZ(2,"mat-icon",2),t._uU(3,"grid_view"),t.qZA(),t.TgZ(4,"h4",3),t._uU(5),t.qZA()(),t.TgZ(6,"button",4),t.NdJ("click",function(){return o.onOpenBoardModal()}),t.TgZ(7,"mat-icon",5),t._uU(8,"delete_outline"),t.qZA()(),t._UZ(9,"mat-divider",6),t.qZA()),2&e&&(t.xp6(5),t.Oqu(o.board.title))},dependencies:[u.RK,B.Tg,j.d,f.Hw],styles:[".board_item[_ngcontent-%COMP%]{background-color:#fdcbcb;width:14rem;height:14rem;margin:.5rem;padding-top:1.5rem}@media (max-width: 425px){.board_item[_ngcontent-%COMP%]{height:10rem}}.board_link[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;align-items:center}.board_item-icon[_ngcontent-%COMP%]{padding-right:1.5rem!important}.board_header[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;width:100%;margin:0;font-weight:700;padding-top:3rem;text-align:center}.board_remove-button[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px}.board_remove-button__icon[_ngcontent-%COMP%]{font-size:1.2rem;color:#0000008a}"]}),n})();function tt(n,r){1&n&&t._UZ(0,"app-create-board")}function et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",5)(1,"p",6),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onCreatingBoard())}),t._uU(5),t.ALo(6,"translate"),t.qZA()()}2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"MAIN_PAGE.no_boards")),t.xp6(3),t.hij(" ",t.lcZ(6,4,"MAIN_PAGE.new_board_button")," "))}function nt(n,r){1&n&&t._UZ(0,"app-board",10),2&n&&t.Q6J("board",r.$implicit)}function ot(n,r){if(1&n&&(t.TgZ(0,"mat-nav-list",8),t.YNc(1,nt,1,1,"app-board",9),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.allBoards)}}let it=(()=>{class n{constructor(e,o,i){this.modalsService=e,this.boardsStore=o,this.notificationService=i,this.userId=""}onCreatingBoard(){this.modalsService.showCreateBoardModal=!0}ngOnInit(){this.boardsSubscription=this.boardsStore.select(J).subscribe(e=>this.allBoards=e),this.errorsSubscription=this.boardsStore.select(L).subscribe(e=>{""!==e&&this.notificationService.openNotification(e)})}ngOnDestroy(){this.boardsSubscription.unsubscribe(),this.errorsSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Y.F),t.Y36(c.yh),t.Y36(M.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-main-page"]],decls:8,vars:6,consts:[[4,"ngIf"],["noboards",""],[1,"boards"],[1,"boards-list_header","text-2xl","font-bold"],["class","boards-list mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",4,"ngIf","ngIfElse"],[1,"bg-rose-100","rounded-lg","p-4","text-center"],[1,"text-gray-500","text-xl"],["mat-flat-button","","color","warn",1,"mt-4","hover:bg-rose-600","text-white","py-2","px-4","rounded",3,"click"],[1,"boards-list","mt-8","grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],["class","bg-white rounded-lg shadow-lg p-4",3,"board",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-lg","p-4",3,"board"]],template:function(e,o){if(1&e&&(t.YNc(0,tt,1,0,"app-create-board",0),t.YNc(1,et,7,6,"ng-template",null,1,t.W1O),t.TgZ(3,"div",2)(4,"h1",3),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.YNc(7,ot,2,1,"mat-nav-list",4),t.qZA()),2&e){const i=t.MAs(2);t.Q6J("ngIf",o.modalsService.showCreateBoardModal),t.xp6(5),t.hij(" ",t.lcZ(6,4,"MAIN_PAGE.title")," "),t.xp6(2),t.Q6J("ngIf",0!==o.allBoards.length)("ngIfElse",i)}},dependencies:[m.sg,m.O5,u.lW,B.Hk,W,V,g.X$],styles:["[_nghost-%COMP%]{padding:3rem;height:100%;overflow-y:auto}.boards-list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}@media (max-width: 425px){.boards-list[_ngcontent-%COMP%]{flex-wrap:nowrap;flex-direction:column}}.no-boards[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding-top:10%}.no-boards[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.6rem;margin-bottom:2.5rem}"]}),n})();var b=l(1206),y=l(4004),rt=l(9300),k=l(4968),_=l(7855);const S=(0,c.ZF)("columns"),st=(0,c.P1)(S,n=>n.columns),at=(0,c.P1)(S,n=>n.columns.length),Q=(0,c.P1)(S,n=>n.boardUsers),K=(0,c.P1)(S,n=>n.error);function lt(n,r){1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CREATE_COLUMN.formError")," "))}let ct=(()=>{class n{constructor(e,o,i){this.data=e,this.dialogRef=o,this.columnStore=i}ngOnInit(){this.columnStore.pipe((0,c.Ys)(at)).subscribe(e=>{this.order=e}),this.createColumnForm=new s.cw({title:new s.NI("",[s.kI.required])})}get title(){return this.createColumnForm.get("title")}onSubmit(){this.createColumnForm.valid&&(this.columnStore.dispatch(h.o8({title:this.title?.value,order:this.order,boardId:this.data.id})),this.dialogRef.close())}onClose(){this.dialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.Kt),t.Y36(_.zj),t.Y36(c.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-column-modal"]],decls:17,vars:11,consts:[[1,"create-column","flex","flex-col","items-center","justify-center","bg-gray-100","rounded-lg","p-8",3,"formGroup","ngSubmit"],[1,"text-2xl","font-bold","mb-6"],[1,"create-column_inputs-container","w-full","mb-6"],["appearance","fill",1,"w-full"],["matInput","","formControlName","title","required","",1,"w-full"],[4,"ngIf"],["mat-raised-button","","color","warn","type","submit",1,"bg-rose-500","text-white","px-8","py-2","rounded-lg"],["mat-icon-button","",1,"close-modal-btn","absolute","top-2","right-2",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(1,"h2",1),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",4),t.YNc(10,lt,3,3,"mat-error",5),t.qZA()(),t.TgZ(11,"button",6),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"button",7),t.NdJ("click",function(){return o.onClose()}),t.TgZ(15,"mat-icon"),t._uU(16,"close"),t.qZA()()()),2&e&&(t.Q6J("formGroup",o.createColumnForm),t.xp6(2),t.hij(" ",t.lcZ(3,5,"CREATE_COLUMN.title")," "),t.xp6(5),t.Oqu(t.lcZ(8,7,"CREATE_COLUMN.label")),t.xp6(3),t.Q6J("ngIf",o.title.invalid),t.xp6(2),t.hij(" ",t.lcZ(13,9,"CREATE_COLUMN.button")," "))},dependencies:[m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,u.lW,u.RK,f.Hw,p.KE,p.hX,p.TO,x.Nt,g.X$],styles:["[_nghost-%COMP%]{position:absolute;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center;width:100%;max-width:400px;padding:1rem 0;background:linear-gradient(#f6f9fa,#fafdff) no-repeat;border-radius:4px;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}.create-column[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:1rem 4rem}.create-column_inputs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.close-modal-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:inherit}.close-modal-btn[_ngcontent-%COMP%]:hover{color:#3f51b5}"]}),n})();function dt(n,r){if(1&n&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function mt(n,r){if(1&n&&(t.TgZ(0,"div",7)(1,"mat-form-field")(2,"mat-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"mat-select",8),t.YNc(6,dt,2,2,"mat-option",9),t.qZA()()()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,"ASSIGN_USERS.users")),t.xp6(3),t.Q6J("ngForOf",e.restUsers)}}function ut(n,r){1&n&&(t.TgZ(0,"p",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"ASSIGN_USERS.no-users")))}let pt=(()=>{class n{constructor(e,o,i,a){this.data=e,this.dialogRef=o,this.userService=i,this.boardsStore=a,this.userId="",this.restUsers=[]}ngOnInit(){this.userId=this.data.board.owner,this.userSubscription=this.userService.getUsers().pipe((0,y.U)(e=>e.filter(o=>o._id!==this.data.board.owner))).subscribe(e=>this.restUsers=e.filter(o=>!this.data.board.users.includes(o._id))),this.createAssignUserForm()}get usersSelect(){return this.assignUsersForm.get("usersSelect")}createAssignUserForm(){this.assignUsersForm=new s.cw({usersSelect:new s.NI("")})}onAssignUser(){if(this.usersSelect?.value){const e={title:this.data.board.title,owner:this.data.board.owner,users:[...this.data.board.users,...this.usersSelect?.value]};this.boardsStore.dispatch(v.YS({board:e,boardId:this.data.board._id}))}this.dialogRef.close()}onClose(){this.dialogRef.close()}ngOnDestroy(){this.userSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.Kt),t.Y36(_.zj),t.Y36(U.K),t.Y36(c.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-assign-users"]],decls:14,vars:9,consts:[[1,"assign-user-form",3,"formGroup","ngSubmit"],["formDirective","ngForm"],["class","assign-user-form_inputs-container",4,"ngIf","ngIfElse"],["noUsers",""],["mat-raised-button","","color","warn","type","submit"],["mat-icon-button","",1,"close-modal-btn",3,"click"],["mat-list-icon",""],[1,"assign-user-form_inputs-container"],["formControlName","usersSelect","multiple",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"no-users"]],template:function(e,o){if(1&e&&(t.TgZ(0,"form",0,1),t.NdJ("ngSubmit",function(){return o.onAssignUser()}),t.TgZ(2,"h2"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,mt,7,4,"div",2),t.YNc(6,ut,3,3,"ng-template",null,3,t.W1O),t.TgZ(8,"button",4),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"button",5),t.NdJ("click",function(){return o.onClose()}),t.TgZ(12,"mat-icon",6),t._uU(13," close "),t.qZA()()()),2&e){const i=t.MAs(7);t.Q6J("formGroup",o.assignUsersForm),t.xp6(3),t.Oqu(t.lcZ(4,5,"ASSIGN_USERS.title")),t.xp6(2),t.Q6J("ngIf",0!==o.restUsers.length)("ngIfElse",i),t.xp6(4),t.hij(" ",t.lcZ(10,7,"ASSIGN_USERS.assign-button")," ")}},dependencies:[m.sg,m.O5,s._Y,s.JJ,s.JL,s.sg,s.u,u.lW,u.RK,f.Hw,p.KE,p.hX,w.gD,P.ey,g.X$],styles:["[_nghost-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;width:100%;max-width:400px;padding:1rem 0;background:linear-gradient(#f6f9fa,#fafdff) no-repeat;border-radius:4px;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}.assign-user-form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:1rem 4rem}.assign-user-form_inputs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:1.5rem;width:100%}.close-modal-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:inherit}.close-modal-btn[_ngcontent-%COMP%]:hover{color:#a51212}.no-users[_ngcontent-%COMP%]{padding-bottom:1.5rem}"]}),n})();var O=l(9017),Z=(()=>{return(n=Z||(Z={})).TITLE_REQUIRED="Please enter a board title",n.COLUMN_TITLE_REQUIRED="Please enter a column title",n.TASK_TITLE_REQUIRED="Please enter a task title",n.DESCRIPTION_REQUIRED="Plaese enter a task description",Z;var n})();function gt(n,r){1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CREATE_TASK_MODAL.formTitleError")," "))}function _t(n,r){1&n&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CREATE_TASK_MODAL.formDescriptionError")," "))}function ft(n,r){if(1&n&&(t.TgZ(0,"mat-option",10),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}let ht=(()=>{class n{constructor(e,o,i,a,d){this.data=e,this.dialogRef=o,this.userStore=i,this.tasksStore=a,this.columnsStore=d,this.userId="",this.assignedUsers=[]}ngOnInit(){this.userIdSubscription=this.userStore.select(R.PR).subscribe(e=>this.userId=e?._id),this.columnsStore.select(Q).subscribe(e=>this.assignedUsers=e),this.createTaskForm=new s.cw({title:new s.NI("",[s.kI.required]),description:new s.NI("",[s.kI.required]),usersSelect:new s.NI("")}),this.taskOrder=this.data.taskOrder}get title(){return this.createTaskForm.get("title")}get description(){return this.createTaskForm.get("description")}get usersSelect(){return this.createTaskForm.get("usersSelect")}get descriptionErrorMessage(){return this.description.hasError("required")?Z.DESCRIPTION_REQUIRED:""}onSubmit(){this.createTaskForm.valid&&(this.tasksStore.dispatch(k.tP({task:{title:this.title?.value,order:this.taskOrder,description:this.description?.value,userId:this.userId,users:this.usersSelect?.value},boardId:this.data.boardId,columnId:this.data.columnId})),this.dialogRef.close())}onClose(){this.dialogRef.close()}ngOnDestroy(){this.userIdSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.Kt),t.Y36(_.zj),t.Y36(c.yh),t.Y36(c.yh),t.Y36(c.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-task-modal"]],decls:29,vars:19,consts:[[1,"create-task",3,"formGroup","ngSubmit"],[1,"create-task_inputs-container"],["appearance","fill"],["matInput","","formControlName","title","required",""],[4,"ngIf"],["matInput","","formControlName","description","required",""],["formControlName","usersSelect","multiple",""],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn","type","submit"],["mat-icon-button","",1,"close-modal-btn",3,"click"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(1,"h2"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",1)(5,"mat-form-field",2)(6,"mat-label"),t._uU(7),t.ALo(8,"translate"),t.qZA(),t._UZ(9,"input",3),t.YNc(10,gt,3,3,"mat-error",4),t.qZA(),t.TgZ(11,"mat-form-field",2)(12,"mat-label"),t._uU(13),t.ALo(14,"translate"),t.qZA(),t._UZ(15,"input",5),t.YNc(16,_t,3,3,"mat-error",4),t.qZA(),t.TgZ(17,"mat-form-field",2)(18,"mat-label"),t._uU(19),t.ALo(20,"translate"),t.qZA(),t.TgZ(21,"mat-select",6),t.YNc(22,ft,2,2,"mat-option",7),t.qZA()()(),t.TgZ(23,"button",8),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"button",9),t.NdJ("click",function(){return o.onClose()}),t.TgZ(27,"mat-icon"),t._uU(28,"close"),t.qZA()()()),2&e&&(t.Q6J("formGroup",o.createTaskForm),t.xp6(2),t.Oqu(t.lcZ(3,9,"CREATE_TASK_MODAL.title")),t.xp6(5),t.Oqu(t.lcZ(8,11,"CREATE_TASK_MODAL.labelTitle")),t.xp6(3),t.Q6J("ngIf",o.title.invalid),t.xp6(3),t.hij(" ",t.lcZ(14,13,"CREATE_TASK_MODAL.labelDescription")," "),t.xp6(3),t.Q6J("ngIf",o.description.invalid),t.xp6(3),t.Oqu(t.lcZ(20,15,"CREATE_BOARD.add-users")),t.xp6(3),t.Q6J("ngForOf",o.assignedUsers),t.xp6(2),t.hij(" ",t.lcZ(25,17,"CREATE_TASK_MODAL.button")," "))},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,u.lW,u.RK,f.Hw,p.KE,p.hX,p.TO,x.Nt,w.gD,P.ey,g.X$],styles:["[_nghost-%COMP%]{position:absolute;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center;width:100%;max-width:400px;padding:1rem 0;background:linear-gradient(#f6f9fa,#fafdff) no-repeat;border-radius:4px;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}.create-task[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:1rem 4rem}.create-task_inputs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%}.close-modal-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:inherit;background-color:#fff}.close-modal-btn[_ngcontent-%COMP%]:hover{color:#3f51b5}"]}),n})();const N=(0,c.ZF)("tasks"),bt=((0,c.P1)(N,n=>n.tasks.length),(0,c.P1)(N,n=>n.tasks)),Ct=(0,c.P1)(N,n=>n.error);function xt(n,r){1&n&&(t.TgZ(0,"mat-error",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"TASK.formTitleError")))}function Tt(n,r){1&n&&(t.TgZ(0,"mat-error",15),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"TASK.formDescriptionError")))}function kt(n,r){if(1&n&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function Ot(n,r){if(1&n&&(t.TgZ(0,"mat-form-field",5)(1,"p"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"mat-select",16),t.YNc(5,kt,2,2,"mat-option",17),t.qZA()()),2&n){const e=t.oxw();t.xp6(2),t.hij("",t.lcZ(3,2,"TASK.assign-users"),":"),t.xp6(3),t.Q6J("ngForOf",e.boardUsersObjects)}}function Zt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",22)(1,"div",23)(2,"p",24),t._uU(3),t.qZA(),t.TgZ(4,"button",25),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.deleteAssignedUser(a._id))}),t.TgZ(5,"mat-icon",26),t._uU(6,"delete_outline"),t.qZA()()()()}if(2&n){const e=r.$implicit;t.xp6(3),t.Oqu(e.name)}}function At(n,r){if(1&n&&(t.TgZ(0,"div",19)(1,"p")(2,"b"),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",20),t.YNc(6,Zt,7,1,"div",21),t.qZA()()),2&n){const e=t.oxw();t.xp6(3),t.hij("",t.lcZ(4,2,"TASK.assignedUsers"),":"),t.xp6(3),t.Q6J("ngForOf",e.assignedUsersObjects)}}let G=(()=>{class n{constructor(e,o,i,a){this.data=e,this.dialogRef=o,this.taskStore=i,this.columnsStore=a,this.boardUsersObjects=[],this.assignedUsersObjects=[],this.assignedUsersIds=[]}ngOnInit(){this.task=this.data,this.getAssignedUsers(),this.formTask=new s.cw({title:new s.NI(`${this.task.title}`,[s.kI.required]),description:new s.NI(`${this.task.description}`),usersSelect:new s.NI("")})}get title(){return this.formTask.get("title")}get description(){return this.formTask.get("description")}get usersSelect(){return this.formTask.get("usersSelect")}get titleErrorMessage(){return this.title.hasError("required")?Z.TASK_TITLE_REQUIRED:""}getAssignedUsers(){this.columnsStore.select(Q).subscribe(e=>{this.boardUsersObjects=[...e].filter(o=>!this.task.users.includes(o._id)),this.assignedUsersObjects=[...e].filter(o=>this.task.users.includes(o._id))}),this.assignedUsersIds=[...this.task.users]}onTaskDataChanged(){if(this.formTask.valid){const e={title:this.title.value,order:this.task.order,columnId:this.task.columnId,description:this.description.value,userId:this.task.userId,users:[...this.assignedUsersIds,...this.usersSelect?.value]};this.taskStore.dispatch(k.xJ({task:e,taskId:this.task._id,boardId:this.task.boardId})),this.dialogRef.close()}}deleteAssignedUser(e){this.assignedUsersIds=this.assignedUsersIds.filter(o=>o!==e),this.assignedUsersObjects=this.assignedUsersObjects.filter(o=>o._id!==e)}onClose(){this.dialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.Kt),t.Y36(_.zj),t.Y36(c.yh),t.Y36(c.yh))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task-edit-form"]],decls:32,vars:17,consts:[[1,"task-container"],[1,"task-container_header"],["mat-dialog-title",""],["mat-dialog-content","",1,"task-form"],[1,"task-form_form",3,"formGroup","ngSubmit"],[1,"task-form_filed"],["aria-hidden","true","fontIcon","title","color","warn"],["matInput","","formControlName","title","required","",1,"task-form_input"],["class","task-form_error",4,"ngIf"],["aria-hidden","true","fontIcon","description","color","warn"],["matInput","","formControlName","description","required","",1,"task-form_input"],["class","task-form_filed",4,"ngIf"],["class","task-form_users-assigned",4,"ngIf"],["mat-raised-button","","color","primary"],["mat-icon-button","",1,"close-modal-btn",3,"click"],[1,"task-form_error"],["formControlName","usersSelect","multiple",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"task-form_users-assigned"],[1,"task-form_users-assigned_container"],["class","users",4,"ngFor","ngForOf"],[1,"users"],[1,"user"],[1,"user_name"],["mat-icon-button","","type","button","color","warn",1,"user_delete-btn",3,"click"],["mat-icon-no-color","",1,"user_delete-btn__icon"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"p",2),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t._UZ(5,"mat-divider"),t.TgZ(6,"div",3)(7,"form",4),t.NdJ("ngSubmit",function(){return o.onTaskDataChanged()}),t.TgZ(8,"mat-form-field",5)(9,"p"),t._UZ(10,"mat-icon",6),t.TgZ(11,"b"),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t._UZ(14,"input",7),t.YNc(15,xt,3,3,"mat-error",8),t.qZA(),t.TgZ(16,"mat-form-field",5)(17,"p"),t._UZ(18,"mat-icon",9),t.TgZ(19,"b"),t._uU(20),t.ALo(21,"translate"),t.qZA()(),t._UZ(22,"textarea",10),t.YNc(23,Tt,3,3,"mat-error",8),t.qZA(),t.YNc(24,Ot,6,4,"mat-form-field",11),t.YNc(25,At,7,4,"div",12),t.TgZ(26,"button",13),t._uU(27),t.ALo(28,"translate"),t.qZA()()(),t.TgZ(29,"button",14),t.NdJ("click",function(){return o.onClose()}),t.TgZ(30,"mat-icon"),t._uU(31,"close"),t.qZA()()()),2&e&&(t.xp6(3),t.hij("",t.lcZ(4,9,"TASK.title"),":"),t.xp6(4),t.Q6J("formGroup",o.formTask),t.xp6(5),t.hij("",t.lcZ(13,11,"TASK.label-title"),":"),t.xp6(3),t.Q6J("ngIf",o.title.invalid),t.xp6(5),t.hij("",t.lcZ(21,13,"TASK.labelDescription"),":"),t.xp6(3),t.Q6J("ngIf",o.title.invalid),t.xp6(1),t.Q6J("ngIf",0!==o.boardUsersObjects.length),t.xp6(1),t.Q6J("ngIf",0!==o.assignedUsersObjects.length),t.xp6(2),t.hij(" ",t.lcZ(28,15,"TASK.save-button")," "))},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,u.lW,u.RK,j.d,f.Hw,p.KE,p.TO,x.Nt,w.gD,P.ey,T.uh,T.xY,g.X$],styles:["[_nghost-%COMP%]{position:absolute;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center;width:100%;max-width:400px;background:linear-gradient(#f6f9fa,#fafdff) no-repeat;border-radius:4px;box-shadow:0 11px 15px -7px #0003,0 24px 38px 3px #00000024,0 9px 46px 8px #0000001f}.task-container[_ngcontent-%COMP%]{width:100%}.task-container_header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.task-container_header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:1rem}.task-form_form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;position:relative;margin:1.5rem}.task-form_filed[_ngcontent-%COMP%]{width:100%;padding:2rem 0 0}.task-form_filed[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;align-items:center}.task-form_filed[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:40px}.task-form_header[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600}.task-form_input[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif}.task-form_users-assigned[_ngcontent-%COMP%]{margin-top:1.5rem}.task-form_users-assigned_container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.task-form_users-assigned_container[_ngcontent-%COMP%]   .users[_ngcontent-%COMP%]{flex:1 1 30%}.task-form_users-assigned_container[_ngcontent-%COMP%]   .users[_ngcontent-%COMP%]   .user[_ngcontent-%COMP%]{display:flex;align-items:center}.task-form_users-assigned_container[_ngcontent-%COMP%]   .users[_ngcontent-%COMP%]   .user_name[_ngcontent-%COMP%], .task-form_users-assigned_container[_ngcontent-%COMP%]   .users[_ngcontent-%COMP%]   .user_delete-btn[_ngcontent-%COMP%]{margin:0}.task-form_users-assigned_container[_ngcontent-%COMP%]   .users[_ngcontent-%COMP%]   .user_delete-btn__icon[_ngcontent-%COMP%]{font-size:1rem;color:#0000008a}.task-form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1.5rem}.close-modal-btn[_ngcontent-%COMP%]{position:absolute;top:0;right:0;z-index:inherit}.close-modal-btn[_ngcontent-%COMP%]:hover{color:#3f51b5}  .task-form .mat-form-field-infix{border-top:0!important}"]}),n})();var z=l(3546);const Mt=function(n){return{hidden:n}};function vt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"mat-card",1)(1,"div",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onOpenTask())}),t.TgZ(2,"mat-card-title",3),t._uU(3),t.qZA()(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.openConfirmModal())}),t.TgZ(5,"mat-icon",5),t._uU(6,"delete_outline"),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("ngClass",t.VKq(2,Mt,!0===e.isDeleted)),t.xp6(3),t.Oqu(e.currentTask.title)}}let wt=(()=>{class n{constructor(e,o,i,a){this.dialog=e,this.tasksStore=o,this.matDialog=i,this.translateService=a,this.isDeleted=!1}onOpenTask(){this.dialog.open(G,{data:this.currentTask})}openConfirmModal(){(0,I.G)(this.matDialog,()=>{this.tasksStore.dispatch(k._5({task:this.currentTask}))},this.translateService.instant("CONFIRM_MODAL.targetTask"))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.Vq),t.Y36(c.yh),t.Y36(T.uw),t.Y36(g.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-task"]],inputs:{currentTask:"currentTask"},decls:1,vars:1,consts:[["class","task",3,"ngClass",4,"ngIf"],[1,"task",3,"ngClass"],[1,"task_data",3,"click"],[1,"task_title"],["mat-icon-button","",1,"task_delete-btn",3,"click"],["mat-icon-no-color","",1,"task_delete-btn__icon"]],template:function(e,o){1&e&&t.YNc(0,vt,7,4,"mat-card",0),2&e&&t.Q6J("ngIf",o.currentTask)},dependencies:[m.mk,m.O5,u.RK,f.Hw,z.a8,z.n5],styles:["[_nghost-%COMP%]{width:100%}.task[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 .5rem 0 1rem}.task_data[_ngcontent-%COMP%]{width:80%;padding:1rem 0}.task_title[_ngcontent-%COMP%]{font-size:.9rem;font-weight:600;margin:0}@media (max-width: 912px){.task_title[_ngcontent-%COMP%]{font-size:.8rem}}.task_delete-btn__icon[_ngcontent-%COMP%]{font-size:1.2rem;color:#0000008a}.hidden[_ngcontent-%COMP%]{display:none}.mat-card-title[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;font-weight:500}.mat-icon-button[_ngcontent-%COMP%]{position:absolute;right:0}"]}),n})();function Pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"h2",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.isFocused=!0)}),t._uU(1),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.column.title," ")}}function St(n,r){1&n&&(t.TgZ(0,"mat-error",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"COLUMN.titleError")))}function Ut(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"form",11),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangeTitle())}),t.TgZ(1,"mat-form-field"),t._UZ(2,"input",12),t.TgZ(3,"div",13)(4,"button",14)(5,"mat-icon",15),t._uU(6,"done"),t.qZA()(),t.TgZ(7,"button",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onCloseTitle())}),t.TgZ(8,"mat-icon",15),t._uU(9,"close"),t.qZA()()(),t.YNc(10,St,3,3,"mat-error",17),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.formTitleInput),t.xp6(10),t.Q6J("ngIf",e.columnTitle.invalid)}}function It(n,r){1&n&&t._UZ(0,"app-task",19),2&n&&t.Q6J("currentTask",r.$implicit)}let yt=(()=>{class n{constructor(e,o,i,a,d,C){this.columnsStore=e,this.dialog=o,this.taskStore=i,this.notificationService=a,this.matDialog=d,this.translateService=C,this.columnsIds=[],this.isFocused=!1,this.tasks=[]}ngOnInit(){this.boardId=this.column.boardId,this.formTitleInput=new s.cw({columnTitle:new s.NI(`${this.column.title}`,[s.kI.required])}),this.tasksSubscription=this.taskStore.select(bt).subscribe(e=>{this.tasks=e.filter(o=>o.columnId===this.column._id),this.tasks.sort((o,i)=>o.order-i.order)}),this.errorTasksSubscription=this.taskStore.select(Ct).subscribe(e=>{""!==e&&this.notificationService.openNotification(e)}),this.getColumnsIds()}getColumnsIds(){for(let e of this.columns)this.columnsIds.push(e._id)}get columnTitle(){return this.formTitleInput.get("columnTitle")}onCloseTitle(){this.isFocused=!1,this.formTitleInput.patchValue({columnTitle:this.column.title})}onChangeTitle(){this.formTitleInput.valid&&(this.columnsStore.dispatch(h.ey({boardId:this.boardId,column:{title:this.columnTitle.value,order:this.column.order},columnId:this.column._id})),this.isFocused=!1)}openConfirmModal(){(0,I.G)(this.matDialog,()=>{this.columnsStore.dispatch(h.eA({_id:this.column._id,boardId:this.column.boardId}))},this.translateService.instant("CONFIRM_MODAL.targetCol"))}onAddTask(){this.dialog.open(ht,{data:{columnId:this.column._id,boardId:this.boardId,taskOrder:this.tasks.length}})}dropTasks(e){e.previousContainer===e.container?((0,b.bA)(e.container.data,e.previousIndex,e.currentIndex),this.tasks=this.tasks.map(i=>{const a=e.container.data.findIndex(d=>d._id===i._id);return(i={...i}).order=a,i})):((0,b.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),this.tasks=this.tasks.map(i=>{const a=e.container.data.findIndex(d=>d._id===i._id);return(i={...i}).order=a,i.columnId=e.container.id,i}));const o=this.makeTasksSet(e.container.data,this.column._id);this.taskStore.dispatch(k.dd({tasks:o}))}makeTasksSet(e,o){return e.map((a,d)=>({_id:a._id,order:d,columnId:o}))}ngOnDestroy(){this.tasksSubscription.unsubscribe(),this.errorTasksSubscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.yh),t.Y36(_.Vq),t.Y36(c.yh),t.Y36(M.g),t.Y36(T.uw),t.Y36(g.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-column-component"]],inputs:{column:"column",columns:"columns"},decls:30,vars:16,consts:[[1,"column-title_wrapper"],[1,"column-title"],["header",""],["class","column-title_form",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["mat-icon-button","","aria-label","Column menu",1,"column-title__menu",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"],["cdkDropList","",1,"tasks_container",3,"id","cdkDropListData","cdkDropListConnectedTo","cdkDropListDropped"],["cdkDrag","",3,"currentTask",4,"ngFor","ngForOf"],["mat-menu-item","",1,"add-task-button",3,"click"],[1,"column-title_header",3,"click"],[1,"column-title_form",3,"formGroup","ngSubmit"],["matInput","","formControlName","columnTitle","required","",1,"column-title_input"],[1,"column-title_buttons"],["mat-icon-button","","matSuffix","","color","accent","type","submit",1,"button"],[1,"icon"],["mat-icon-button","","matSuffix","","type","button",1,"button",3,"click"],["class","column-title_error",4,"ngIf"],[1,"column-title_error"],["cdkDrag","",3,"currentTask"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,Pt,2,1,"ng-template",null,2,t.W1O),t.YNc(4,Ut,11,2,"form",3),t.qZA(),t.TgZ(5,"button",4)(6,"mat-icon"),t._uU(7,"more_vert"),t.qZA()(),t.TgZ(8,"mat-menu",null,5)(10,"button",6),t.NdJ("click",function(){return o.onAddTask()}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA(),t.TgZ(13,"span"),t._uU(14),t.ALo(15,"translate"),t.qZA()(),t.TgZ(16,"button",6),t.NdJ("click",function(){return o.openConfirmModal()}),t.TgZ(17,"mat-icon"),t._uU(18,"delete_forever"),t.qZA(),t.TgZ(19,"span"),t._uU(20),t.ALo(21,"translate"),t.qZA()()()(),t.TgZ(22,"div",7),t.NdJ("cdkDropListDropped",function(a){return o.dropTasks(a)}),t.YNc(23,It,1,1,"app-task",8),t.qZA(),t.TgZ(24,"button",9),t.NdJ("click",function(){return o.onAddTask()}),t.TgZ(25,"mat-icon"),t._uU(26,"add"),t.qZA(),t.TgZ(27,"span"),t._uU(28),t.ALo(29,"translate"),t.qZA()()),2&e){const i=t.MAs(3),a=t.MAs(9);t.xp6(4),t.Q6J("ngIf",o.isFocused)("ngIfElse",i),t.xp6(1),t.Q6J("matMenuTriggerFor",a),t.xp6(9),t.Oqu(t.lcZ(15,10,"COLUMN.add-task")),t.xp6(6),t.Oqu(t.lcZ(21,12,"COLUMN.delete-button")),t.xp6(2),t.s9C("id",o.column._id),t.Q6J("cdkDropListData",o.tasks)("cdkDropListConnectedTo",o.columnsIds),t.xp6(1),t.Q6J("ngForOf",o.tasks),t.xp6(5),t.Oqu(t.lcZ(29,14,"COLUMN.add-task"))}},dependencies:[m.sg,m.O5,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,u.RK,f.Hw,p.KE,p.TO,p.R9,x.Nt,O.VK,O.OP,O.p6,b.Wj,b.Zt,wt,g.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;width:17rem;min-width:17rem;padding:10px;margin-bottom:10px;box-sizing:border-box;cursor:move;font-size:14px;border-radius:4px;background:linear-gradient(#fbf1f1,#8292f3) no-repeat}@media (max-width: 760px){[_nghost-%COMP%]{width:13rem;min-width:13rem}}.column-title[_ngcontent-%COMP%]{overflow:hidden;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical}.column-title_wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}.column-title_header[_ngcontent-%COMP%]{width:100%;font-weight:600;font-size:14px;margin-top:-.2em;margin-bottom:0;margin-left:10px}.column-title__menu[_ngcontent-%COMP%]{align-self:baseline}.column-title_form[_ngcontent-%COMP%]{display:flex;position:relative}.column-title_input[_ngcontent-%COMP%]{width:75%;font-weight:600;font-size:14px;font-family:Montserrat,sans-serif}@media (max-width: 760px){.column-title_input[_ngcontent-%COMP%]{width:55%}}.column-title_buttons[_ngcontent-%COMP%]{position:absolute;right:0;top:3px;display:flex}.column-title_buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{width:1.2rem;line-height:1.2rem;height:1.2rem}.column-title_buttons[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1rem;width:1rem;height:1rem;line-height:1}@media (max-width: 760px){.column-title_buttons[_ngcontent-%COMP%]{right:37px}}.tasks_container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;row-gap:.4rem;height:100%;overflow-y:hidden}.tasks_container[_ngcontent-%COMP%]:hover{overflow-y:auto}.add-task-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin-bottom:auto}.add-task-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:10px!important}  .column-title .mat-form-field-infix{border-top:0!important;margin-top:6px!important;margin-left:10px!important}  .mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:.45em!important}  .mat-form-field-appearance-legacy .mat-form-field-underline{bottom:.5em!important}"]}),n})();function Nt(n,r){if(1&n&&(t.TgZ(0,"h1",14),t._uU(1),t.ALo(2,"translate"),t.TgZ(3,"b"),t._uU(4),t.qZA()()),2&n){const e=t.oxw();t.Q6J("title",e.board.title),t.xp6(1),t.hij(" ",t.lcZ(2,3,"BOARD_PAGE.title"),": "),t.xp6(3),t.Oqu(e.board.title)}}function Et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",17),t._uU(2),t.ALo(3,"uppercase"),t.qZA(),t.TgZ(4,"mat-menu",null,18)(6,"div",19)(7,"p",20),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"div",21)(11,"p",22),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"p",23),t._uU(15),t.qZA()(),t.TgZ(16,"div",21)(17,"p",22),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"p",23),t._uU(21),t.qZA()(),t.TgZ(22,"button",24),t.NdJ("click",function(){const a=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.onDeleteUser(a._id))}),t._uU(23),t.ALo(24,"translate"),t.qZA()()()()}if(2&n){const e=r.$implicit,o=t.MAs(5);t.xp6(1),t.Q6J("matMenuTriggerFor",o),t.xp6(1),t.hij(" ",t.lcZ(3,8,e.name.slice(0,1))," "),t.xp6(6),t.hij(" ",t.lcZ(9,10,"BOARD_PAGE.user-info")," "),t.xp6(4),t.hij(" ",t.lcZ(13,12,"BOARD_PAGE.user-name"),": "),t.xp6(3),t.Oqu(e.name),t.xp6(3),t.hij(" ",t.lcZ(19,14,"BOARD_PAGE.user-login"),": "),t.xp6(3),t.Oqu(e.login),t.xp6(2),t.hij(" ",t.lcZ(24,16,"BOARD_PAGE.delete-button")," ")}}function Ft(n,r){if(1&n&&(t.TgZ(0,"div",15),t.YNc(1,Et,25,18,"div",16),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.boardUsers)}}function qt(n,r){if(1&n&&t._UZ(0,"app-column-component",25),2&n){const e=r.$implicit,o=t.oxw();t.Q6J("column",e)("columns",o.columns)("cdkDragData",e)}}let Dt=(()=>{class n{constructor(e,o,i,a,d,C,Yt,Bt){this.route=e,this.boardsStore=o,this.columnStore=i,this.tasksStore=a,this.dialog=d,this.notificationService=C,this.userService=Yt,this.router=Bt,this.board={},this.boardId="",this.columns=[],this.boardUsers=[]}ngOnInit(){this.route.params.subscribe(e=>this.boardId=e.id),this.subscriptionBoard=this.boardsStore.select(J).pipe((0,y.U)(e=>e.find(o=>o._id===this.boardId))).subscribe(e=>{this.board=e,this.getBoardUsers()}),this.errorsSubscrBoards=this.boardsStore.select(K).subscribe(e=>{""!==e&&this.notificationService.openNotification(e)}),this.columnStore.dispatch(h.Pu({boardId:this.boardId})),this.columnStore.dispatch(h.So({boardId:this.boardId})),this.tasksStore.dispatch(k.km({boardId:this.boardId})),this.getAllColumns()}getBoardUsers(){return this.userService.getUsers().pipe((0,rt.h)(e=>!!e)).subscribe(e=>{this.boardUsers=[...e].filter(o=>this.board?.users?.includes(o._id)),this.columnStore.dispatch(h.zP({boardUsers:this.boardUsers}))})}onCreateColumn(){this.dialog.open(ct,{data:{id:this.boardId}})}onOpenUserDialog(){this.dialog.open(pt,{data:{board:this.board,existingUsers:this.boardUsers}})}getAllColumns(){this.subscriptionColumns=this.columnStore.select(st).pipe((0,y.U)(e=>[...e].sort((o,i)=>o.order-i.order))).subscribe(e=>this.columns=e),this.errorsSubscrColumns=this.columnStore.select(K).subscribe(e=>{""!==e&&this.notificationService.openNotification(e)})}dropColumns(e){(0,b.bA)(this.columns,e.previousIndex,e.currentIndex);const o=[];this.columns.map((i,a)=>o.push({_id:i._id,order:a})),this.columnStore.dispatch(h.H1({columns:o}))}onDeleteUser(e){const o=this.boardUsers.filter(a=>a._id!==e).map(a=>a._id);this.boardsStore.dispatch(v.YS({board:{title:this.board.title,owner:this.board.owner,users:o},boardId:this.boardId}))}onNavigateToMain(){this.router.navigateByUrl("")}ngOnDestroy(){this.boardId="",this.columns=[],this.subscriptionColumns.unsubscribe(),this.subscriptionBoard.unsubscribe(),this.columnStore.dispatch(h.Dt()),this.errorsSubscrBoards.unsubscribe(),this.errorsSubscrColumns.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A.gz),t.Y36(c.yh),t.Y36(c.yh),t.Y36(c.yh),t.Y36(_.Vq),t.Y36(M.g),t.Y36(U.K),t.Y36(A.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-board-page"]],decls:21,vars:7,consts:[[1,"board_header","bg-rose-100"],[1,"board_title"],["mat-icon-button","","aria-label","Back",3,"click"],[3,"title",4,"ngIf"],[1,"board_controls"],["mat-raised-button","","color","warn","type","button",1,"add-col",3,"click"],["mat-mini-fab","","color","warn","aria-label","add column",1,"add-col-mob",3,"click"],[1,"board_header_users"],[1,"assign-user"],["mat-icon-button","","color","warn",1,"assign-user_btn",3,"click"],[1,"assign-user__icon"],["class","board_users",4,"ngIf"],["id","columnDragList","cdkDropList","","cdkDropListOrientation","horizontal",1,"min-w-full","min-h-screen-34","flex","flex-wrap","gap-5","overflow-x-auto","overflow-y-hidden",3,"cdkDropListData","cdkDropListDropped"],["cdkDropListGroup","","cdkDrag","",3,"column","columns","cdkDragData",4,"ngFor","ngForOf"],[3,"title"],[1,"board_users"],[4,"ngFor","ngForOf"],["mat-icon-button","","color","warn",1,"user_btn",3,"matMenuTriggerFor"],["menu","matMenu"],[1,"w-52","mt-[-8px]","flex","flex-col","items-stretch"],[1,"p-4","bg-blue-500","text-white","text-center"],[1,"flex","flex-wrap","px-2"],[1,"text-xs","text-gray-500","mr-2"],[1,"user_info__title-data"],["mat-stroked-button","","color","warn",3,"click"],["cdkDropListGroup","","cdkDrag","",3,"column","columns","cdkDragData"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return o.onNavigateToMain()}),t.TgZ(3,"mat-icon"),t._uU(4,"arrow_back"),t.qZA()(),t.YNc(5,Nt,5,5,"h1",3),t.qZA(),t.TgZ(6,"div",4)(7,"button",5),t.NdJ("click",function(){return o.onCreateColumn()}),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return o.onCreateColumn()}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA()(),t.TgZ(13,"div",7)(14,"div",8)(15,"button",9),t.NdJ("click",function(){return o.onOpenUserDialog()}),t.TgZ(16,"mat-icon",10),t._uU(17,"person_add_alt"),t.qZA()()(),t.YNc(18,Ft,2,1,"div",11),t.qZA()()(),t.TgZ(19,"div",12),t.NdJ("cdkDropListDropped",function(a){return o.dropColumns(a)}),t.YNc(20,qt,1,3,"app-column-component",13),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngIf",o.board),t.xp6(3),t.hij(" ",t.lcZ(9,5,"BOARD_PAGE.create-column")," "),t.xp6(10),t.Q6J("ngIf",0!==o.boardUsers.length),t.xp6(1),t.Q6J("cdkDropListData",o.columns),t.xp6(1),t.Q6J("ngForOf",o.columns))},dependencies:[m.sg,m.O5,u.lW,u.RK,u.nh,f.Hw,O.VK,O.p6,b.Wj,b.Fd,b.Zt,yt,m.gd,g.X$],styles:["[_nghost-%COMP%]{height:calc(100% - 218px - 1rem);padding:1rem;display:flex;flex-direction:column;background-color:#f3f5fb}.board_header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.board_header_users[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}@media (max-width: 460px){.board_header_users[_ngcontent-%COMP%]{gap:.2rem}}.board_header[_ngcontent-%COMP%]   .add-col[_ngcontent-%COMP%]{display:block}@media (max-width: 912px){.board_header[_ngcontent-%COMP%]   .add-col[_ngcontent-%COMP%]{display:none}}.board_header[_ngcontent-%COMP%]   .add-col-mob[_ngcontent-%COMP%]{display:none}@media (max-width: 912px){.board_header[_ngcontent-%COMP%]   .add-col-mob[_ngcontent-%COMP%]{display:block}}@media (max-width: 460px){.board_header[_ngcontent-%COMP%]   .add-col-mob[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:29px;height:29px}}.board_title[_ngcontent-%COMP%]{display:flex;align-items:center;width:70%}.board_title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin:0 15px 0 0}@media (max-width: 912px){.board_title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-right:10px;font-size:1.1rem}}@media (max-width: 460px){.board_title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:.9rem}}@media (max-width: 1280px){.board_title[_ngcontent-%COMP%]{width:55%}}@media (max-width: 460px){.board_title[_ngcontent-%COMP%]{width:50%}}.board_controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:30%}@media (max-width: 1280px){.board_controls[_ngcontent-%COMP%]{width:45%}}@media (max-width: 460px){.board_controls[_ngcontent-%COMP%]{width:50%}}.board_users[_ngcontent-%COMP%]{display:flex}.board_users[_ngcontent-%COMP%]   .assign-user_btn[_ngcontent-%COMP%]{border:1px solid #3f51b5;color:#3f51b5;background-color:#fff;line-height:36px;margin-right:1.5rem}.board_users[_ngcontent-%COMP%]   .user_btn[_ngcontent-%COMP%]{border:2px solid #ffffff;color:#fff;background-color:#3f51b5;line-height:36px;margin-left:-10px}@media (max-width: 912px){.board_users[_ngcontent-%COMP%]   .user_btn[_ngcontent-%COMP%]{width:30px;height:30px;line-height:14px}}@media (max-width: 460px){.board_users[_ngcontent-%COMP%]   .user_btn[_ngcontent-%COMP%]{width:27px;height:27px}}.user_info[_ngcontent-%COMP%]{width:13rem;margin-top:-8px;display:flex;flex-direction:column;align-items:stretch}.user_info[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:128px;margin:0 .5rem}.user_info[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"]}),n})();var E=l(5288),F=l(4514),Jt=l(3602);let Lt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,s.UX,s.u5,$.q,Jt.m,A.Bz.forChild([{path:"",component:it,canActivate:[F.a,E.w]},{path:"board/:id",component:Dt,canActivate:[F.a,E.w]},{path:"board/:id/task/:id",component:G,canActivate:[F.a,E.w]}])]}),n})()}}]);